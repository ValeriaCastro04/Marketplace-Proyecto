<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestionar Catálogo de Productos</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<header>
    <img src="img/SiVARMARKET-LOGO1.png" alt="SiVARMARKET Logo" id="logo">
    <nav>
        <ul>
            <li><a href="VendedorPerfil.html">Mi perfil</a></li>
            <li><a href="CrearCatalogo.html">Crear catálogo</a></li>
            <li><a href="GestionarCatalogo.html">Gestionar catálogo</a></li>
            <li><a href="OpcionesVendedor.html">Opciones</a></li>
            <li><a href="Soporte.html">Soporte</a></li>
        </ul>
    </nav>
</header>

<div class="titulo">
    <h1>Gestionar Catálogo de Productos</h1>
</div>

<section id="catalogo-productos">
    <h2>Mis Productos</h2>
    <div id="productosContainer"></div>
</section>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const vendedorId = localStorage.getItem("vendedorId");

    if (!vendedorId) {
        alert("Debes iniciar sesión para ver tus productos.");
        window.location.href = "LogInVendedor.html";
    }

    const productosContainer = document.getElementById("productosContainer");

    const cargarProductos = async () => {
        try {
            const productosRef = collection(db, "productos");
            const q = query(productosRef, where("vendedorId", "==", vendedorId));
            const querySnapshot = await getDocs(q);

            productosContainer.innerHTML = "";
            
            querySnapshot.forEach((doc) => {
                const producto = doc.data();
                const productoElement = document.createElement("div");
                productoElement.classList.add("producto");

                productoElement.innerHTML = `
                    <h3>${producto.nombre}</h3>
                    <p>Descripción: ${producto.descripcion}</p>
                    <p>Precio: $${producto.precio}</p>
                    <p>Categoría: ${producto.categoria}</p>
                    <p>Estado: <strong>${producto.estado}</strong></p>
                `;

                productosContainer.appendChild(productoElement);
            });

            if (querySnapshot.empty) {
                productosContainer.innerHTML = "<p>No tienes productos en el catálogo.</p>";
            }

        } catch (error) {
            console.error("Error al cargar los productos:", error);
            alert("Error: No se pudieron cargar los productos.");
        }
    };

    cargarProductos();
</script>

</body>
</html>
